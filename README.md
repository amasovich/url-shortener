# Сервис сокращения ссылок (консольное приложение)

Этот проект — консольное приложение для сокращения длинных URL с дополнительными функциями:

- **Лимит переходов** (ограничение количества кликов по ссылке);
- **Время жизни** (срок действия ссылки);
- **Уведомления** (оповещения при недоступности ссылки);
- **Работа нескольких пользователей** (идентификация по UUID);
- **Переход по короткой ссылке** через браузер.

## Возможности приложения

- Регистрация пользователей и выдача уникального UUID;
- Авторизация по UUID для работы с личными ссылками;
- Создание коротких ссылок с учётом системных ограничений на TTL и лимиты;
- Редактирование лимитов переходов и времени жизни;
- Удаление ссылок;
- Уведомления о недоступности ссылок;
- Удаление устаревших ссылок;
- Просмотр всех ссылок текущего пользователя.

## Использование и команды

После запуска доступны следующие команды:

- `register <name>` — регистрирует нового пользователя, выводит его UUID;
- `login <uuid>` — войти в систему как пользователь с данным UUID;
- `shorten <url>` — создать короткую ссылку (системные параметры TTL и лимита переходов применяются автоматически);
- `list` — вывести список всех ссылок текущего пользователя;
- `goto <shortId>` — открыть оригинальный URL в браузере;
- `edit-limit <shortId> <newLimit>` — изменить лимит переходов для ссылки;
- `edit-expiry <shortId> <newTTL>` — изменить время жизни ссылки;
- `delete <shortId>` — удалить короткую ссылку;
- `clean` — удалить устаревшие ссылки;
- `whoAmI` — показать текущего пользователя (UUID и имя);
- `delete-user <uuid>` — удалить пользователя;
- `exit` — выйти из приложения.

## Установка и запуск

1. **Склонировать репозиторий:**

   ```bash
   git clone https://github.com/amasovich/url-shortener.git
   cd url-shortener
   ```

2. **Собрать и запустить (Maven):**

   ```bash
   mvn clean compile
   mvn exec:java -Dexec.mainClass="com.beryoza.urlshortener.ShortLinkConsoleApp"
   ```

## Структура проекта

```plaintext
url-shortener
├─ pom.xml                  # Файл сборки Maven
├─ README.md                # Описание проекта (этот файл)
├─ .gitignore
└─ src
   ├─ main
   │  ├─ java
   │  │  └─ com.beryoza.urlshortener
   │  │     ├─ Config.java
   │  │     ├─ ShortLink.java
   │  │     ├─ ShortLinkConsoleApp.java
   │  │     ├─ ShortLinkRepository.java
   │  │     ├─ ShortLinkService.java
   │  │     ├─ User.java
   │  │     ├─ UserRepository.java
   │  │     └─ UserService.java
   │  └─ resources
   │     └─ application.properties
   └─ test
      ├─ java
      │  └─ com.beryoza.urlshortener
      │     └─ ShortLinkServiceTest.java
      └─ resources
         └─ testconfig.properties
```

## Пример сценария работы

1. **Регистрация пользователя:**

   ```
   > register Vladimir
   Пользователь зарегистрирован. Ваш UUID: 123e4567-e89b-12d3-a456-426614174001
   ```

2. **Авторизация:**

   ```
   > login 123e4567-e89b-12d3-a456-426614174001
   Успешный вход. Добро пожаловать, Vladimir!
   ```

3. **Создание короткой ссылки:**

   ```
   > shorten https://vk.com/amasovich
   Ссылка создана: abc123
   ```

4. **Список ссылок:**

   ```
   > list
   Ваши ссылки:
   - abc123 -> https://vk.com/amasovich (лимит: 100, переходов: 0, истекает через: 48 часов)
   ```

5. **Редактирование лимита переходов:**

   ```
   > edit-limit abc123 50
   Лимит успешно изменён на 50.
   ```

6. **Редактирование времени жизни ссылки:**

   ```
   > edit-expiry abc123 24
   Время жизни ссылки abc123 успешно изменено на 24 часов.
   ```

7. **Удаление ссылки:**

   ```
   > delete abc123
   Ссылка abc123 успешно удалена.
   ```

8. **Переход по ссылке:**

   ```
   > goto abc123
   Ссылка открыта в браузере: https://vk.com/amasovich
   ```

9. **Очистка устаревших ссылок:**

   ```
   > clean
   Очистка завершена. Устаревшие ссылки удалены.
   ```

10. **Просмотр текущего пользователя:**

```
> whoAmI
Текущий пользователь: Vladimir (UUID: 123e4567-e89b-12d3-a456-426614174001)
```

11. **Удаление пользователя:**

```
> delete-user 123e4567-e89b-12d3-a456-426614174001
Пользователь с UUID 123e4567-e89b-12d3-a456-426614174001 успешно удалён.
```

12. **Выход из приложения:**

```
> exit
Завершение работы программы. До свидания!
```

## Тестирование

Для обеспечения корректной работы функциональности были реализованы юнит-тесты в классе `ShortLinkServiceTest`. Основные проверяемые аспекты:

- **Уникальность ссылок:** Генерация уникальных коротких ссылок для разных пользователей.
- **Ограничение переходов:** Ссылки блокируются при превышении заданного лимита.
- **Время жизни ссылок:** Ссылки удаляются автоматически после истечения срока действия.
- **Уведомления:** Пользователи получают уведомления о недоступности ссылок при блокировке или истечении срока действия.
- **Работа нескольких пользователей:** Проверяется, что каждый пользователь видит только свои ссылки.

Для запуска тестов выполните команду:
```bash
mvn test
```

## Контакты и автор

Проект реализован Березняком Владимиром в рамках учебного задания МИФИ для Promo IT.
Если у вас есть вопросы или предложения, обращайтесь через [GitHub Issues](https://github.com/amasovich/url-shortener/issues).
